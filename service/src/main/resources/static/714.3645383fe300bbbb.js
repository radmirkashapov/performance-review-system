"use strict";(self.webpackChunkprs_ui=self.webpackChunkprs_ui||[]).push([[714],{7714:(O,u,o)=>{o.r(u),o.d(u,{LoginModule:()=>w});var s=o(4660),n=o(2223),r=(()=>((r=r||{})[r.YANDEX=0]="YANDEX",r))(),c=o(8548);let l=(()=>{class e{constructor(t){this.glbApiService=t}getOAuthLink(t){return console.log("getOAuthLink"),this.glbApiService.get("/api/v1/oauth/link",{provider:t})}processYandexCallback(t){return this.glbApiService.post("/api/v1/oauth/yandex/code-login-callback",t)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(c.z))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var p=o(5145),g=o(4755);function x(e,i){1&e&&n._UZ(0,"app-spinner-wrapper")}function v(e,i){1&e&&n._UZ(0,"img",8)}let y=(()=>{class e{constructor(t){this.yandexOAuthService=t,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.yandexOAuthService.getOAuthLink(r[r.YANDEX]).subscribe(t=>{this.yandexOAuthLink=t,this.isLoading=!1})}processClick(){this.yandexOAuthLink&&window.open(this.yandexOAuthLink.link,"_self")}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(l))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-yandex-oauth-login"]],decls:10,vars:2,consts:[[1,"homepage"],[4,"ngIf"],[1,"central-btn-block"],[1,"homepage-title"],[1,"homepage-login-bttn"],[3,"click"],[1,"image-wrapper"],["src","/assets/img/yandex-login-button.svg",4,"ngIf"],["src","/assets/img/yandex-login-button.svg"]],template:function(t,a){1&t&&(n.TgZ(0,"section",0),n.YNc(1,x,1,0,"app-spinner-wrapper",1),n.TgZ(2,"div",2)(3,"section",3)(4,"h1"),n._uU(5,"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043e\u0446\u0435\u043d\u043a\u0438 \u043a\u043e\u043c\u043f\u0435\u0442\u0435\u043d\u0446\u0438\u0439"),n.qZA()(),n.TgZ(6,"section",4)(7,"a",5),n.NdJ("click",function(){return a.processClick()}),n.TgZ(8,"div",6),n.YNc(9,v,1,0,"img",7),n.qZA()()()()()),2&t&&(n.xp6(1),n.Q6J("ngIf",a.isLoading),n.xp6(8),n.Q6J("ngIf",!a.isLoading))},dependencies:[p.C,g.O5],styles:[".homepage[_ngcontent-%COMP%]{height:100%;background:black;display:flex;justify-content:center;align-items:center}.homepage[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-family:Russo One}.central-btn-block[_ngcontent-%COMP%]{text-align:center}.homepage-title[_ngcontent-%COMP%]{margin-bottom:20px}.homepage-login-bttn[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;border-radius:20px;border:1px solid #ffffff;background-color:transparent;transition:box-shadow .3s;overflow:hidden;position:relative}.homepage-login-bttn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;display:flex;justify-content:center}.image-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.homepage-login-bttn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto}.homepage-login-bttn[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px #ffffff80;background-image:linear-gradient(to left,white,black)}.homepage-login-bttn[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:#000}"]}),e})(),L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-login"]],decls:1,vars:0,template:function(t,a){1&t&&n._UZ(0,"app-yandex-oauth-login")},dependencies:[y]}),e})();var m=o(237),C=o(7748),Y=o(8182);function b(e,i){1&e&&n._UZ(0,"app-spinner-wrapper")}const P=s.Bz.forChild([{path:"",pathMatch:"full",component:L},{path:"yandex-code-callback",pathMatch:"full",component:(()=>{class e{constructor(t,a,d,f,h,A,k){this.route=t,this.router=a,this.yandexOauthService=d,this.authJwtProvider=f,this.profileService=h,this.stateService=A,this.authJWTProvider=k,this.isLoading=!0}ngOnInit(){this.isLoading=!0,this.route.queryParams.subscribe(t=>{this.yandexOauthService.processYandexCallback({code:t.code,state:t.state}).subscribe(f=>{this.authJwtProvider.processTokenPair(f),this.profileService.currentUser().subscribe(h=>{this.isLoading=!1,this.stateService.setData(new m.Z(h)),this.redirectToProfile(h)})})})}redirectToProfile(t){this.router.navigateByUrl("/profile")}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(s.gz),n.Y36(s.F0),n.Y36(l),n.Y36(C.M),n.Y36(Y.H),n.Y36(m.b),n.Y36(C.M))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-yandex-oauth-code-login-handler"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,a){1&t&&n.YNc(0,b,1,0,"app-spinner-wrapper",0),2&t&&n.Q6J("ngIf",a.isLoading)},dependencies:[p.C,g.O5]}),e})()}]);var _=o(3939);let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[P,_.G,g.ez]}),e})()},5145:(O,u,o)=>{o.d(u,{C:()=>r});var s=o(2223),n=o(8467);let r=(()=>{class c{constructor(){}ngOnInit(){}}return c.\u0275fac=function(p){return new(p||c)},c.\u0275cmp=s.Xpm({type:c,selectors:[["app-spinner-wrapper"]],decls:2,vars:0,consts:[[1,"spinner-wrapper"]],template:function(p,g){1&p&&(s.TgZ(0,"div",0),s._UZ(1,"mat-spinner"),s.qZA())},dependencies:[n.Ou],styles:[".spinner-wrapper[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;display:flex;justify-content:center;align-items:center;top:0;left:0;background-color:#ffffff80;z-index:998}.spinner-wrapper[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{width:6rem;height:6rem}"]}),c})()}}]);